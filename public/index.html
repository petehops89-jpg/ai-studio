<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Studio - Futuristic Interface</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 50%, #0a0a1a 100%);
            min-height: 100vh;
        }
        
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 255, 255, 0.1);
        }
        
        .glass-hover:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(0, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(0, 255, 255, 0.2);
        }
        
        .neon-glow {
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }
        
        .chat-message {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .gradient-text {
            background: linear-gradient(90deg, #00FFFF, #BF00FF, #FF5F1F);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .scrollbar-custom::-webkit-scrollbar {
            width: 8px;
        }
        
        .scrollbar-custom::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .scrollbar-custom::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #00FFFF, #BF00FF);
            border-radius: 10px;
        }
        
        .pulse-ring {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
    </style>
</head>
<body class="text-white p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-500 to-purple-600 flex items-center justify-center">
                        <i data-lucide="sparkles" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold gradient-text">AI Studio</h1>
                        <p class="text-gray-400 text-sm">Next-gen creative workspace</p>
                    </div>
                </div>
                <div class="flex gap-2">
                    <div class="pulse-ring w-3 h-3 rounded-full bg-green-400"></div>
                    <span class="text-sm text-gray-400">All systems operational</span>
                </div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Chat Section -->
            <div class="glass rounded-2xl p-6 flex flex-col h-[600px]">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <i data-lucide="message-square" class="w-5 h-5 text-cyan-400"></i>
                        <h2 class="text-xl font-semibold">AI Chat</h2>
                    </div>
                    <select id="modelSelect" class="glass rounded-lg px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-400">
                        <option value="mistralai/mistral-7b-instruct:free">Mistral 7B</option>
                        <option value="meta-llama/llama-3.3-70b-instruct:free">Llama 3.3 70B</option>
                    </select>
                </div>
                
                <div id="chatMessages" class="flex-1 overflow-y-auto scrollbar-custom mb-4 space-y-3">
                    <div class="glass rounded-lg p-4">
                        <p class="text-gray-300 text-sm">ðŸ‘‹ Welcome to AI Studio! Ask me anything...</p>
                    </div>
                </div>
                
                <div class="flex gap-2">
                    <input 
                        type="text" 
                        id="chatInput" 
                        placeholder="Type your message..." 
                        class="flex-1 glass rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-cyan-400"
                    />
                    <button id="sendBtn" class="glass-hover rounded-lg px-6 py-3 bg-gradient-to-r from-cyan-500 to-purple-600 font-semibold flex items-center gap-2">
                        <i data-lucide="send" class="w-4 h-4"></i>
                        Send
                    </button>
                </div>
            </div>

            <!-- Image Generation Section -->
            <div class="glass rounded-2xl p-6 flex flex-col h-[600px]">
                <div class="flex items-center gap-2 mb-4">
                    <i data-lucide="image" class="w-5 h-5 text-purple-400"></i>
                    <h2 class="text-xl font-semibold">Image Generation</h2>
                </div>
                
                <div class="flex-1 flex flex-col">
                    <textarea 
                        id="imagePrompt" 
                        placeholder="Describe the image you want to create..." 
                        class="glass rounded-lg px-4 py-3 mb-4 h-32 resize-none focus:outline-none focus:ring-2 focus:ring-purple-400 scrollbar-custom"
                    ></textarea>
                    
                    <button id="generateImageBtn" class="glass-hover rounded-lg px-6 py-3 bg-gradient-to-r from-purple-600 to-orange-500 font-semibold flex items-center justify-center gap-2 mb-4">
                        <i data-lucide="wand-2" class="w-4 h-4"></i>
                        Generate Image
                    </button>
                    
                    <div id="imageOutput" class="flex-1 glass rounded-lg flex items-center justify-center overflow-hidden">
                        <div class="text-center text-gray-400">
                            <i data-lucide="image-plus" class="w-16 h-16 mx-auto mb-2 opacity-50"></i>
                            <p class="text-sm">Your generated image will appear here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Generation Section -->
        <div class="glass rounded-2xl p-6 mt-6">
            <div class="flex items-center gap-2 mb-4">
                <i data-lucide="video" class="w-5 h-5 text-orange-400"></i>
                <h2 class="text-xl font-semibold">Video Generation</h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <textarea 
                    id="videoPrompt" 
                    placeholder="Describe your video scene..." 
                    class="glass rounded-lg px-4 py-3 resize-none focus:outline-none focus:ring-2 focus:ring-orange-400 scrollbar-custom md:col-span-2 h-24"
                ></textarea>
                
                <button id="generateVideoBtn" class="glass-hover rounded-lg px-6 py-3 bg-gradient-to-r from-orange-500 to-green-400 font-semibold flex items-center justify-center gap-2">
                    <i data-lucide="film" class="w-4 h-4"></i>
                    Generate Video
                </button>
            </div>
            
            <div id="videoStatus" class="mt-4 glass rounded-lg p-4 hidden">
                <div class="flex items-center gap-3">
                    <div class="animate-spin">
                        <i data-lucide="loader-2" class="w-5 h-5 text-orange-400"></i>
                    </div>
                    <span class="text-sm">Generating video...</span>
                </div>
            </div>
            
            <div id="videoOutput" class="mt-4 hidden">
                <video controls class="w-full rounded-lg glass"></video>
            </div>
        </div>
    </div>

    <script>
        lucide.createIcons();
        
        // Chat functionality
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        const modelSelect = document.getElementById('modelSelect');
        
        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;
            
            addMessage(message, 'user');
            chatInput.value = '';
            
            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message,
                        model: modelSelect.value
                    })
                });
                
                const data = await response.json();
                addMessage(data.response, 'assistant');
            } catch (error) {
                addMessage('Error: Failed to get response', 'error');
            }
        }
        
        function addMessage(text, type) {
            const msgDiv = document.createElement('div');
            msgDiv.className = 'chat-message glass rounded-lg p-4';
            
            const icon = type === 'user' 
                ? '<i data-lucide="user" class="w-4 h-4 inline mr-2 text-cyan-400"></i>'
                : type === 'error'
                ? '<i data-lucide="alert-circle" class="w-4 h-4 inline mr-2 text-red-400"></i>'
                : '<i data-lucide="bot" class="w-4 h-4 inline mr-2 text-purple-400"></i>';
            
            msgDiv.innerHTML = `${icon}<span class="text-sm text-gray-300">${text}</span>`;
            chatMessages.appendChild(msgDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            lucide.createIcons();
        }
        
        sendBtn.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        
        // Image generation with Puter.js
        const imagePrompt = document.getElementById('imagePrompt');
        const generateImageBtn = document.getElementById('generateImageBtn');
        const imageOutput = document.getElementById('imageOutput');
        
        generateImageBtn.addEventListener('click', async () => {
            const prompt = imagePrompt.value.trim();
            if (!prompt) return;
            
            generateImageBtn.disabled = true;
            generateImageBtn.innerHTML = '<i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i> Generating...';
            lucide.createIcons();
            
            try {
                const result = await puter.ai.txt2img(prompt);
                imageOutput.innerHTML = `<img src="${result}" alt="Generated" class="w-full h-full object-contain rounded-lg"/>`;
            } catch (error) {
                imageOutput.innerHTML = `<div class="text-red-400 text-center"><i data-lucide="alert-circle" class="w-8 h-8 mx-auto mb-2"></i><p>Error generating image</p></div>`;
                lucide.createIcons();
            }
            
            generateImageBtn.disabled = false;
            generateImageBtn.innerHTML = '<i data-lucide="wand-2" class="w-4 h-4"></i> Generate Image';
            lucide.createIcons();
        });
        
        // Video generation
        const videoPrompt = document.getElementById('videoPrompt');
        const generateVideoBtn = document.getElementById('generateVideoBtn');
        const videoStatus = document.getElementById('videoStatus');
        const videoOutput = document.getElementById('videoOutput');
        
        generateVideoBtn.addEventListener('click', async () => {
            const prompt = videoPrompt.value.trim();
            if (!prompt) return;
            
            generateVideoBtn.disabled = true;
            videoStatus.classList.remove('hidden');
            videoOutput.classList.add('hidden');
            
            try {
                const response = await fetch('/api/video', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt })
                });
                
                const data = await response.json();
                
                if (data.videoUrl) {
                    videoOutput.querySelector('video').src = data.videoUrl;
                    videoOutput.classList.remove('hidden');
                } else {
                    throw new Error('No video URL returned');
                }
            } catch (error) {
                videoStatus.innerHTML = '<div class="flex items-center gap-3 text-red-400"><i data-lucide="alert-circle" class="w-5 h-5"></i><span class="text-sm">Error generating video</span></div>';
                lucide.createIcons();
            }
            
            generateVideoBtn.disabled = false;
            setTimeout(() => videoStatus.classList.add('hidden'), 3000);
        });
    </script>
</body>
  </html>
